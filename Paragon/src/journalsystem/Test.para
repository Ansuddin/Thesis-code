
import java.lang.System;
import java.util.Scanner;
import java.util.ArrayList;
import org.jpy.PyLib;
import com.fasterxml.jackson.core.*;
import com.fasterxml.jackson.databind.ObjectMapper;

public class Test {
	public static !(Policy.lowD + Policy.trusted) void main(?Policy.untrusted String[] args){
		
		
		String ssn = "270793-2131";
		String name = "Ans Uddin";
		String address = "Knapmagerstien 49";
		String publicNote = "antibiotika intolerance";
		String[] publicSessions = {" D-vitamin deficiancy"};
		String[] privateSessions = {"Treatment for panic attacks started"};

		

		PatientJournalD journal = new PatientJournalD(ssn, name, address, publicNote, publicSessions,	privateSessions);
		
		journal.setSsn("test");
		String test = journal.getSsn();
		Doctor doctor = new Doctor();

		?(Policy.lowD+Policy.untrusted) String untrustedVar = "";
		?(Policy.lowD+Policy.trusted) String trustedVar = "";

		untrustedVar = trustedVar;//OK
		//trustedVar = untrustedVar; // BAD

		trustedVar = Policy.<String>endorse(untrustedVar);

		journal.setPublicNote(Policy.<String>endorse(untrustedVar));


		/*String[] publicVar = journal.getPrivateSessions();
		Doctor doctor = new Doctor();
		open Locks.IsDoctor;
		open Locks.Referred;
		//open Locks.IsReferred(doctor, journal);
		if (Locks.Referred && Locks.IsDoctor){
			journal.addToPrivateSessions("test");
		}*/

		//System.out.println(journal.getName());

		// Test declassify
		// open Locks.IsDoctor{
		// String secret = Policy.<String>declassifyMedium(journal.getName());
		// System.out.println(secret);
		//  }

		policy bottom = {Object x:};
		?(Policy.lowD+Policy.trusted) String low = "";
		?(Policy.mediumD+Policy.trusted) String medium = "";
		?Policy.highD String high = "";

		//OK
		medium = low ;
		high = medium;
		high = low;


		//BAD
		// low = medium;
		// medium = high;
		// low = high;

		open Locks.IsDoctor;
		String out = Policy.<String>declassifyMedium(medium);
		System.out.println(out);


		//open Locks.Referred;
		//low = Policy.<bottom,String>declassifyHigh(high);
		// String pub = Policy.<low,String>declassify("");
		// System.out.print(pub);

/*
		?Policy.lowD String lowVar = "low";
		?Policy.mediumD String mediumVar = "medium";
		?Policy.highD String highVar = "high";

		mediumVar = lowVar; // OK
		//lowVar = mediumVar; // BAD
		open Locks.IsDoctor{
			lowVar = mediumVar; // OK
		}

		highVar = mediumVar; // OK
		//mediumVar = highVar; // BAD
		open Locks.IsReferred(doctor,journal){
			mediumVar = highVar; //OK
			//lowVar = highVar; // BAD
			open Locks.IsDoctor{
				lowVar = highVar;
			}
		}
*/


		
		// If a Patient reads it will flow a high variable
		//?Policy.high String patientreading = journal.getSsn();

		//Patient patient = new Patient();
		//patient.receive(journal);

		// However I can not set the value of SSN 
		//journal.setSsn(patientreading);

		//?TrustedUntrusted.trusted int id = journal.getId();

		//?PatientJournal.high String ssn = journal.getSsn();
		//journal.setPublicNote(ssn);

		//?HighLow.low String fakeSsn = "012345-6789";
		//journal.setSsn(fakeSsn);

		//?PatientJournal.low String note = journal.getPublicNote();
		//journal.addToSessions(note);

		// Confidentiality
		/*											
		?Policy.low String publicVar = "public";
		?Policy.high String secretVar = "secret";

		secretVar = publicVar; // OK
		//publicVar = secretVar; // BAD

		// Integrity
		?Policy.untrusted String untrustedInput = "untrusted";
		?Policy.trusted String trustedInput = "trusted";

		untrustedInput = trustedInput; // OK
		//trustedInput = untrustedInput; // BAD
		*/

		// Label inference

		// Combined policies
		//?(Policy.low2 + Policy.trusted) String name = "Ans";
		//String publicName = name;
		//?(Policy.high2 + Policy.trusted) String test = name;



		// Policy test with fresh and general
		//final policy generalPolicy = { Doctor d : };
		//final policy freshPolicy = { doctor : };
		//?generalPolicy String val1 = "General doctor";
		//?freshPolicy String val2 = "Fresh doctor";
		//?secretary String val3  = "secretary";
		//val1 = val2; // BAD freshpolicy is more secret than generalpolicy. 
		//val2 = val1; // OK only 

		//Policy test with lock
		/*Doctor doctor = new Doctor();

		final policy low = {Doctor d: ; MatrixService m: };
		final policy lowMatrix = {MatrixService m:};
		final policy highDoctor = { Doctor d: Locks.IsDoctor};  
		final policy highMatrix = { Doctor d: Locks.Matrix};
		final policy highMatrixDoctor = { Doctor d: Locks.IsDoctor
										; MatrixService m: Locks.Matrix };
		?low String publicVar = "public";
		?lowMatrix String publicMatrix = "public";
		?highDoctor String secretVarDoc = "secret";
		?highMatrix String secretVarMatrix = "secret";
		?highMatrixDoctor String secret = "secret";*/


		//open Locks.Matrix;
		//publicVar = secretVarDoc;
		//secretVarMatrix = secretVarDoc;
		//publicVar = secret;
		//publicMatrix = secret;

		// publicVar = publicMatrix;

		 // Patientjournal Policy test
		/*Object lowObserver = new Object();
		Object highObserver = new Object();
		final policy low = {lowObserver: ; highObserver:};
		final policy medium = {highObserver:};
		final policy high = {(Doctor d, PatientJournal p)  highObserver: Locks.IsReferred(d,p)};

		?low String publicVar = "public";
		?medium String mediumVar = "medium";
		?high String secretVar = "secret";
		secretVar = publicVar; // OK
		//publicVar = secretVar; // BAD
		mediumVar = publicVar; // OK
		//publicVar = mediumVar; // BAD
		secretVar = mediumVar; // OK
		//mediumVar = secretVar; // BAD


		/*Doctor doctor = new Doctor();
		PatientJournal journal = new PatientJournal();
		open Locks.IsReferred(doctor,journal);
		mediumVar = secretVar; // OK*/

	}
}